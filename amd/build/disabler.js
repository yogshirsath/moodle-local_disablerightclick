define(["jquery","core/ajax","core/notification","core/modal_factory","core/modal_events","core/templates"],function(e,o,t,n,i,a){return{init:function(){var i=[],c={SETTINGS:function(e){return o.call([{methodname:"local_disablerightclick_settings",args:{contextid:e}}])[0]},SUPPORT:function(e){return o.call([{methodname:"local_disablerightclick_support",args:{action:e}}])[0]}},l={91:"commandLeft",93:"commandRight",18:"option",73:"I",67:"C",85:"U",74:"J",75:"K",83:"S",69:"E",88:"X",86:"V"};function d(o,t){null==t&&(t=2e3);var n=e("<div class='disabler-toaster toaster-container'><lable class='toaster-message'>"+o+"</lable></div>");e("html").append(n),e(n).addClass("show"),setTimeout(function(){e(n).addClass("fade"),setTimeout(function(){e(n).removeClass("fade"),setTimeout(function(){e(n).remove()},300)},t)})}function r(e,o){var t=!1;return(o=o.trim().split("\n")).forEach(function(o){t||-1!=e.indexOf(o.trim())&&(t=!0)}),t}function s(e,o){if(0!=o.length){var t=window.location.href;if(""==o.allowall||!r(t,o.allowall)){if(o.disablerightclick&&1==o.disablerightclick){if(""!=o.allowrightclick&&r(t,o.allowrightclick))return;e.contextmenu(function(e){d(i.rightclick),e.preventDefault()})}if(o.disablecutcopypaste&&1==o.disablecutcopypaste){if(""!=o.allowcutcopypaste&&r(t,o.allowcutcopypaste))return;var n={};e.on("keydown",function(e){if(console.log("event.keyCode",e.keyCode),n[l[e.keyCode]]="keydown"==e.type,console.log("map",n),1==e.ctrlKey&&-1!=[65,67,83,86,88].indexOf(e.keyCode)||(n.commandLeft||n.commandRight)&&n.C||(n.commandLeft||n.commandRight)&&n.X||(n.commandLeft||n.commandRight)&&n.V)return d(i.cutcopypaste),void e.preventDefault()}),e.on("keyup",function(e){"keyup"==e.type&&(n[l[e.keyCode]]=!1),console.log("map",n)})}if(o.disabledevelopertools&&1==o.disabledevelopertools){if(""!=o.allowdevelopertools&&r(t,o.allowdevelopertools))return;!function(e){var o={};e.on("keydown",function(e){if(console.log("event.keyCode",e.keyCode),o[l[e.keyCode]]="keydown"==e.type,console.log("map",o),123==e.keyCode||1==e.ctrlKey&&1==e.shiftKey&&-1!=[67,73,74].indexOf(e.keyCode)||1==e.ctrlKey&&-1!=[85].indexOf(e.keyCode)||(o.commandLeft||o.commandRight)&&o.option&&o.I||(o.commandLeft||o.commandRight)&&o.option&&o.C||(o.commandLeft||o.commandRight)&&o.option&&o.U||(o.commandLeft||o.commandRight)&&o.option&&o.J||(o.commandLeft||o.commandRight)&&o.option&&o.K||(o.commandLeft||o.commandRight)&&o.option&&o.S||(o.commandLeft||o.commandRight)&&o.option&&o.E)return d(i.developertools),void e.preventDefault()}),e.on("keyup",function(e){"keyup"==e.type&&(o[l[e.keyCode]]=!1),console.log("map",o)})}(e)}}}}e(document).ready(function(){var o=0;null!=M.cfg.contextid&&(o=M.cfg.contextid),c.SETTINGS(o).done(function(o){var l,d=JSON.parse(o);i=d.strings,s(e("body"),d.settings),l=d.showsupport,d.context,1==l&&n.create({type:n.types.DEFAULT,title:i.supporttitle,body:a.render("local_disablerightclick/support_modal",{})},e("#create-modal")).done(function(o){o.getRoot(),o.show(),e("body").on("click","[data-action-disablerightclick]",function(){c.SUPPORT(e(this).data("value")),o.destroy()})}).fail(t.exception),setInterval(function(){0!=e("iframe").length&&e("iframe:not(.applied-disablement)").each(function(o,t){e(this).addClass("applied-disablement"),s(e(t.contentWindow.document.body),d.settings)})},1e3)}).fail(t.exception)})}}});